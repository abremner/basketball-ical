
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Waverley Basketball Fixtures</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; }
    h1 { color: #333; }
    label, select { display: block; margin-top: 1rem; }
    #calendar-link { margin-top: 2rem; display: none; }
  </style>
</head>
<body>
  <h1>Waverley Basketball Fixture Calendars</h1>
  <p>Select your team to view or subscribe to their calendar:</p>

  <label for="season">Season:</label>
  <select id="season"><option value="">Select Season</option></select>

  <label for="ageGroup">Age Group:</label>
  <select id="ageGroup"><option value="">Select Age Group</option></select>

  <label for="division">Division:</label>
  <select id="division"><option value="">Select Division</option></select>

  <label for="team">Team:</label>
  <select id="team"><option value="">Select Team</option></select>

  <div id="calendar-link">
    <p><a id="icsLink" href="#" target="_blank">ðŸ“… View or Subscribe to Calendar</a></p>
  </div>

  <script>
    const data = {}; // will be injected by scraper.js
    const seasonSelect = document.getElementById('season');
    const ageGroupSelect = document.getElementById('ageGroup');
    const divisionSelect = document.getElementById('division');
    const teamSelect = document.getElementById('team');
    const linkContainer = document.getElementById('calendar-link');
    const icsLink = document.getElementById('icsLink');

    function clearSelect(select) {
      select.innerHTML = '<option value="">Select</option>';
    }

    function populateSelect(select, options) {
      clearSelect(select);
      options.forEach(opt => {
        const o = document.createElement('option');
        o.value = opt;
        o.textContent = opt;
        select.appendChild(o);
      });
    }

    seasonSelect.addEventListener('change', () => {
      clearSelect(ageGroupSelect);
      clearSelect(divisionSelect);
      clearSelect(teamSelect);
      linkContainer.style.display = 'none';
      const ageGroups = Object.keys(data[seasonSelect.value] || {});
      populateSelect(ageGroupSelect, ageGroups);
    });

    ageGroupSelect.addEventListener('change', () => {
      clearSelect(divisionSelect);
      clearSelect(teamSelect);
      linkContainer.style.display = 'none';
      const divisions = Object.keys(data[seasonSelect.value]?.[ageGroupSelect.value] || {});
      populateSelect(divisionSelect, divisions);
    });

    divisionSelect.addEventListener('change', () => {
      clearSelect(teamSelect);
      linkContainer.style.display = 'none';
      const teams = Object.keys(data[seasonSelect.value]?.[ageGroupSelect.value]?.[divisionSelect.value] || {});
      populateSelect(teamSelect, teams);
    });

    teamSelect.addEventListener('change', () => {
      const season = seasonSelect.value;
      const age = ageGroupSelect.value;
      const div = divisionSelect.value;
      const team = teamSelect.value;
      const link = data[season]?.[age]?.[div]?.[team];
      if (link) {
        icsLink.href = link;
        icsLink.textContent = `ðŸ“… ${team} Calendar`;
        linkContainer.style.display = 'block';
      } else {
        linkContainer.style.display = 'none';
      }
    });

    // Injected data structure
    window.onload = () => {
      const seasons = Object.keys(data);
      populateSelect(seasonSelect, seasons);
    };
  </script>
</body>
</html>
